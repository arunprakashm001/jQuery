<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valplug(only)</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js" integrity="sha512-rstIgDs0xPgmG6RX1Aba4KV5cWJbAMcvRCVmglpam9SoHZiUCyQVDdH2LPlxoHtrv17XWblE/V/PP+Tr04hbtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">  
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script> -->

    <style>
        body{
            background-image: url(./jQuery-img/pexels-andreea-ch-1166644sm.jpg);
        }
        .error{
            color: red;
        }
    </style>

</head>
<body>
    <h1 class="text-success text-center" style="background-color:lightgreen; padding: 10px; border: 2px solid green">jQuery Validation Plugin(only)</h1>
    <br>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
            <button class="btn btn-lg btn-info" id="btn1" data-toggle="modal" data-target="#addform">ADD FORM+</button>
            <button type="button" class="btn btn-lg btn-warning" id="btn2" data-toggle="modal" data-target="#Editform">EDIT FORM !</button>
        </div>
        </div>
        
    </div> <br>

    <div class="container">
        <table id="taccess" class="table table-bordered table-striped">
            <thead>
                <th>Employee Name</th>
                <th>Employee Age</th>
                <th>Employee Id</th>
                <th>Employee Email</th>
                <th>Employee Address</th>
                <th>Gender</th>
                <th>E.Shifts</th>
                <th>E.Skills</th>
                <th>Actions</th>
            </thead>
            <tbody id="tbodyaccess">
               
            </tbody>
        </table>
    </div>

    <div class="container">
    <div id="addform" class="modal fade" role="dialog" >
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 class="text-center">ADD+ FORM</h3>
                </div>
                <div class="modal-body">
                    
                <form  id="add_faccess" onsubmit="event.preventDefault()">
                    <div class="row">
                        <div class="col-md-6">
                        <label for="">Employee Name:</label>
                        <input type="text" id="adfname" class="form-control" name="name" placeholder="Enter your name">
                        <div></div>
                        </div>
                        <div class="col-md-6">
                            <label for="">Employee Age:</label>
                            <input type="number" id="adfage" class="form-control" name="age" placeholder="Enter your age">
                            <div></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="">Employee ID:</label>
                            <input type="number" id="empid" class="form-control" name="id" placeholder="Enter your ID">
                            <div></div> 
                        </div>
                        <div class="col-md-6">
                            <label for="">Employee Email:</label>
                            <input type="email" class="form-control" name="email" placeholder="Enter your email" id="adfemail">
                            <div></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="">Employee Address:</label>
                            <textarea name="address" id="adfaddress" cols="30" rows="3" class="form-control"></textarea>
                            <div></div>
                        </div>
                    </div> <br>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="">Employee Gender:</label>
                            <br>
                            <input type="radio" name="gender" class="form-check-input" value="Male">
                            <label for="">Male</label>
                            <input type="radio" name="gender" class="form-check-input" value="Female">
                            <label for="">Female</label>
                            <input type="radio" name="gender" class="form-check-input" value="Others">
                            <label for="">Others</label>
                            <div></div> 
                        </div>
                        
                        <div class="col-md-6">
                            <label for="">Select your shifts:</label> <br>
                            <select class="form-select" aria-label="Default select example" name="adfshifts">
                                <option value="" selected="selected">--select--</option>
                                <option value="Firstshift" name="addsht">Firstshift</option>
                                <option value="Secondshift" name="addsht">Secondshift</option>
                                <option value="Thirdshift" name="addsht">Thirdshift</option>
                                <option value="Fourthshift"name="addsht">Fourthshift</option>
                            </select>
                            <div></div>
                        </div>
                    </div>
                   
                    <div class="row">
                        <br>
                        <div class="col-md-12">
                            <label for="">Select Skills:</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="HTML">
                            <label for="">HTML</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="JAVA">
                            <label for="">JAVA</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="Phython">
                            <label for="">Phython</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="Javascript">
                            <label for="">Javascript</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="Php">
                            <label for="">Php</label>
                            <input type="checkbox" class="form-check-input" name="adfskills" value="SQL">
                            <label for="">SQL</label>
                            <div></div>
                        </div>
                        
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-12">
                            <button class="btn btn-primary btn-block" id="adfsubmit">SUBMIT</button>
                        </div>
                    </div>

                </form>
                </div>
            </div>
        </div>
    </div>


    <!-- ------------------------------------------Edit form ------------------------------------------------------ -->

    <div id="Editform" class="modal fade" role="dialog" >
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 class="text-center">EDIT FORM</h3>
                </div>
                <div class="modal-body">
                    
                <form  id="ed_faccess" onsubmit="event.preventDefault()" >
                    <div class="row">
                        <div class="col-md-6">
                        <label for="">Employee Name:</label>
                        <input type="text" id="edfname" name="f2name" class="form-control" placeholder="Enter your name">
                        <div></div>
                        </div>
                        <div class="col-md-6">
                            <label for="">Employee Age:</label>
                            <input type="number" id="edfage" name="f2age" class="form-control" placeholder="Enter your age">
                            <div></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="">Employee ID:</label>
                            <input type="number" id="edfid" name="f2id" class="form-control" placeholder="Enter your ID">
                            <div></div> 
                        </div>
                        <div class="col-md-6">
                            <label for="">Employee Email:</label>
                            <input type="email" class="form-control" name="f2email" placeholder="Enter your email" id="edfemail">
                            <div></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="">Employee Address:</label>
                            <textarea name="f2address" id="edfaddress" cols="30" rows="3" class="form-control"></textarea>
                            <div></div>
                        </div>
                    </div> <br>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="">Employee Gender:</label>
                            <br>
                            <input type="radio" name="f2gender" class="form-check-input" value="Male">
                            <label for="">Male</label>
                            <input type="radio" name="f2gender" class="form-check-input" value="Female">
                            <label for="">Female</label>
                            <input type="radio" name="f2gender" class="form-check-input" value="Others">
                            <label for="">Others</label>
                            <div></div>
                        </div>
                        <div class="col-md-6">
                            <label for="">Select your shifts:</label> <br>
                            <select class="form-select" aria-label="Default select example" name="f2shifts">
                                <option  value="" selected="selected" name="edsht">--select--</option>
                                <option value="Firstshift" name="edsht">Firstshift</option>
                                <option value="Secondshift" name="edsht">Secondshift</option>
                                <option value="Thirdshift" name="edsht">Thirdshift</option>
                                <option value="Fourthshift" name="edsht">Fourthshift</option>
                              </select>
                              <div></div>
                    </div>
                    </div>
                    <div class="row">
                        <br>
                        <div class="col-md-12">
                            <label for="">Select Skills:</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="HTML">
                            <label for="">HTML</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="JAVA">
                            <label for="">JAVA</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="Phython">
                            <label for="">Phython</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="Javascript">
                            <label for="">Javascript</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="Php">
                            <label for="">Php</label>
                            <input type="checkbox" class="form-check-input" name="f2skills" value="SQL">
                            <label for="">SQL</label>
                            <div></div>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-12">
                            <button class="btn btn-success btn-block" id="edfupdate">UPDATE</button>
                        </div>
                    </div>

                </form>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script>
        $(document).ready(function(){

// var table=$('#taccess').DataTable(); //datatable

$.validator.addMethod('lettersonly', function(value, element){
    return this.optional(element)||/^[A-Za-z\.]+$/.test(value);    
},'Alphabets only');

$.validator.addMethod('emailval', function(value,element){
    return this.optional(element)|| /^[a-z0-9]+@gmail+(?:\.com+)$/.test(value);
},'Enter a valid email like(abcd@gmail.com)');

$.validator.addMethod('addval', function(value,element){
    return this.optional(element)|| /^[a-zA-Z0-9\.\/\,\ ]+$/.test(value);
},'Enter a valid address with(, / space a-z A-Z 0-9)');

$("#add_faccess").validate({
    rules:{
        name : {
            required:true,
            minlength:4,
            maxlength:25,
            lettersonly:true
            
        },
        age : {
            required:true,
            number:true,
            min:18,
            max:100

        },
        id : {
            required:true,
            number:true,
            minlength:6,
            maxlength:6
        },
        email : {
            required:true,
            minlength:14,
            maxlength:40,
            emailval:true
        },
        address : {
            required:true,
            minlength:10,
            addval:true

        },
        gender : {
            required:true
        },
        adfshifts : {
            required:true
        },
        adfskills : {
            required:true
        }
    },
    messages : {
        name : {
            required:"Name is required",
            minlength:"Minimum 4 characters is required",
            maxlength:"Maximum 25 characters only allowed"
        },
        age : {
            required:"Please Enter your age",
            number:"Enter Numbers only",
            min:"Please Enter Acceptable age(18)",
            max:"Enter a valid age(18-100)"
        },
        id : {
            required:"Employee Id is required",
            number:"Numbers only",
            minlength:"Enter your correct ID with 6 numbers(e.g:221122)",
            maxlength:"Enter a valid ID(Maximum 6 numbers only allowed)"
        },
        email : {
            required:"Email field is required",
            minlength:"Minimum 14 characters is required for valid email",
            maxlength:"Maximum 40 characters only allowed"
        },
        address : {
            required:"Address is required",

        },
        gender : {
            required:"Please select gender"
        },
        adfshifts : {
            required: "Please select your working shift",
        },
       
    },
    errorPlacement: function(error, element){
        if (element.attr('type')==="radio" || element.attr('type') === 'checkbox'){
            error.appendTo(element.closest('div'));
        }
        else{
            error.appendTo(element.next('div'));
        }
    }
});


$("#ed_faccess").validate({
    rules:{
        f2name : {
            required:true,
            minlength:4,
            maxlength:25,
            lettersonly:true
            
        },
        f2age : {
            required:true,
            number:true,
            min:18,
            max:100

        },
        f2id : {
            required:true,
            number:true,
            minlength:6,
            maxlength:6
        },
        f2email : {
            required:true,
            minlength:14,
            maxlength:40,
            emailval:true
        },
        f2address : {
            required:true,
            minlength:10,
            addval:true

        },
        f2gender : {
            required:true
        },
        f2shifts : {
            required:true
        },
        f2skills : {
            required:true
        }
    },
    messages : {
        f2name : {
            required:"Name is required",
            minlength:"Minimum 4 characters is required",
            maxlength:"Maximum 25 characters only allowed"
        },
        f2age : {
            required:"Please Enter your age",
            number:"Enter Numbers only",
            min:"Please Enter Acceptable age(18)",
            max:"Enter a valid age(18-100)"
        },
        f2id : {
            required:"Employee Id is required",
            number:"Numbers only",
            minlength:"Enter your correct ID with 6 numbers(e.g:221122)",
            maxlength:"Enter a valid ID(Maximum 6 numbers only allowed)"
        },
        f2email : {
            required:"Email field is required",
            minlength:"Minimum 14 characters is required for valid email",
            maxlength:"Maximum 40 characters only allowed"
        },
        f2address : {
            required:"Address is required",

        },
        f2gender : {
            required:"Please select gender"
        },
        f2shifts : {
            required: "Please select your working shift",
        },
    },
    errorPlacement: function(error, element){
        if (element.attr('type')==="radio" || element.attr('type') === 'checkbox'){
            error.appendTo(element.closest('div'));
        }
        else{
            error.appendTo(element.next('div'));
        }
    }

});

$('#adfsubmit').click(function(){
    var form;
    $('#add_faccess').each(function(){
        form=$("input,textarea,select",this)
    });
    if($("#add_faccess").valid()){
       var checking = $.fn.dataRead(form);
       $.fn.arrayfun(checking);
       $.fn.tableinsert();
       alert("Data's are successfully inserted on table");
    }

});

$('#edfupdate').click(function(){
    var form2;
    $('#ed_faccess').each(function(){
        form2=$("input,textarea,select",this)
        // console.log(form2)
    });

    if($("#ed_faccess").valid()){
        $.fn.dataRead(form2);
        $.fn.onUpdate();
        alert("Data's are successfully updated on table :-) ");
    }

});


 $.fn.dataRead = function(form_id){
        var info = {};
        var loop = form_id;
        // console.log(loop);
        for(var i=0; i<loop.length; i++){
            var getform = loop.get([i]);
            // console.log(getform);
            // console.log(getform.name);

            if(getform.type=="text"){
                var txtval = getform.value;
                info.name=txtval;
            }

            if(getform.type=="number"){
                var numval = getform.value;
                if(getform.id=="empid"){
                    info.id=numval;
                }
                else{
                    info.age=numval;
                }
            }

            if(getform.type=="email"){
                var emailval=getform.value;
                info.email=emailval;
            }

            if(getform.type=="textarea"){
                var addressval = getform.value;
                info.address=addressval;
            }

            if(getform.type=="radio"){
                var radios = $("[type=radio]");
                for(let i=0; i<radios.length; i++){
                    var radiocheck = radios.get([i]);
                    if(radiocheck.checked){
                        var rval=radiocheck.value;
                        info.gender=rval;
                    }
                }
            }

            if(getform.name=="adfshifts"){
                let dropdown =  $('[name="addsht"]');
                // console.log(dropdown)
    
                for(let n=0; n<dropdown.length; n++){
                    if(dropdown[n].selected){
                        var dropval=dropdown[n].value;
                        info.shift=dropval;
                    }

                }
            }
            else if(getform.name=="f2shifts"){
                let dropdown =  $('[name="edsht"]');
                // console.log(dropdown)
                for(let n=0; n<dropdown.length; n++){
                    if(dropdown[n].selected){
                        var dropval=dropdown[n].value;
                        info.shift=dropval;
                    }

                }
            }

            if(getform.type=="checkbox"){
                var cbox = $("[type=checkbox]");
                var carray=[];
                for(let i=0; i<cbox.length; i++){
                    var cbcheck= cbox.get([i]);
                    if(cbcheck.checked){
                        carray.push(cbcheck.value);
                        info.skills=carray;
                    }                    
                }
            }

        }
        // console.log(info);
        return info;
    }

    var arraydata=[];
    $.fn.arrayfun = function(employee){
        arraydata.push(employee)
        console.log(arraydata)
    }

    $.fn.tableinsert = function(){
        $("#tbodyaccess").html(" ");
    //    table.clear(); // to clear DataTable
        
       for(var i=0; i<arraydata.length; i++){
        
        var tabledata = "<tr><td>" + arraydata[i].name + "</td><td>" + arraydata[i].age + "</td><td>"+arraydata[i].id+ "</td><td>"+arraydata[i].email+"</td><td>"+arraydata[i].address+"</td><td>"+arraydata[i].gender+"</td><td>"+arraydata[i].shift+"</td><td>"+arraydata[i].skills+"</td><td>"+"<button class='btn btn-warning' onclick='$.fn.onEdit("+arraydata[i].id+")' >EDIT</button> <button class= 'btn btn-danger' onclick='$.fn.onDelete("+arraydata[i].id+")'>DELETE</button>" +"</td></tr>";

        $('#tbodyaccess').append(tabledata);
        // $('#taccess').DataTable().row.add($(tabledata).get(0)).draw(); // to add row in DataTable
        $("#add_faccess")[0].reset();
       }

    }

    $.fn.onEdit = function(td){
        $("#ed_faccess")[0].reset();
        // console.log(td);
        alert("Click Edit form! button to change your details");

        for(var j=0; j<arraydata.length; j++){
            if(td==arraydata[j].id){
                $("#edfname").val(arraydata[j].name);
                $("#edfage").val(arraydata[j].age);
                $("#edfid").val(arraydata[j].id);
                $("#edfage").val(arraydata[j].age);
                $("#edfemail").val(arraydata[j].email);
                $("#edfaddress").val(arraydata[j].address);

                var radioed = arraydata[j].gender;
                var radios = $("[type=radio]");
                for(var l=0; l<radios.length; l++){
                    var radiocheck = radios.get([l]);
                    if(radioed==radiocheck.value){
                        radiocheck.checked=true;
                    } 
                }

                var droped = arraydata[j].shift;
                var dropdownval =  $('[name="edsht"]');
                for(var m=0; m<dropdownval.length; m++){
                    var ddcheck = dropdownval.get([m]);
                    if(droped==ddcheck.value){
                        ddcheck.selected=true;
                    }
                }

                var cboxed = arraydata[j].skills;
                var cvalue=cboxed.toString();
                var cboxval = $("[name=f2skills]");
                var skillsary = cvalue.split(',');
                for(let n=0; n<cboxval.length; n++){
                    var demo1 = cboxval.get([n]);
                    for(let p=0; p<skillsary.length; p++){
                        if(skillsary[p]==demo1.value){
                            demo1.checked=true;
                        }
                    }
                }
                
            }
        }
        
       
    }

    $.fn.onUpdate = function(){

        let get1 =  $("#edfname").val();
        let get2 =  $("#edfage").val();
        let get3 =  $("#edfid").val();
        let get4 =  $("#edfemail").val();
        let get5 =  $("#edfaddress").val();
  
        var r = $("[type=radio]")
        for(let j=0; j<r.length; j++){
          var rcheck = r.get([j]);
            if(rcheck.checked){
               var get6 = rcheck.value;
            }
        }
  
        var dropdownval =  $('[name="edsht"]');
        for(var m=0; m<dropdownval.length; m++){
            var ddcheck = dropdownval.get([m]);
            if(ddcheck.selected){
                var get7 = ddcheck.value
              //   console.log(get8)
            }
        }
  
        var cboxval = $("[name=f2skills]");
        var skillsary = [];
        for(let n=0; n<cboxval.length; n++){
            var demo1 = cboxval.get([n]);
            if(demo1.checked){
              skillsary.push(demo1.value);
              var get8 = skillsary;
              // console.log(get9);
              
            }
        }
  
        for(let i=0; i<arraydata.length; i++){
          if(arraydata[i].id==get3){
              arraydata[i].name=get1;
              arraydata[i].age=get2;
              arraydata[i].email=get4;
              arraydata[i].address=get5;
              arraydata[i].gender=get6;
              arraydata[i].shift=get7;
              arraydata[i].skills=get8;
              
              console.log(arraydata);
              $.fn.tableinsert();
          }
        }
        $("#ed_faccess")[0].reset();
        
  
      }

      $.fn.onDelete = function(td){

        for(let i=0; i<arraydata.length; i++){
            if(td==arraydata[i].id){
                arraydata.splice(i,1);
                alert("Selected table row has been Deleted successfully!");
                console.log(arraydata);
                $.fn.tableinsert();
                break;
            }
        }
    }







});
    </script>

    

    
</body>
</html>